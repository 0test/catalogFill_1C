<h1>Модуль Синхронизации MODX Evolution + Shopkeeper c системой 1С</h1>

Описание:
За основу взят модуль импорта/экспорта товаров <a href="http://www.modx-shopkeeper.ru/documentation/modx-evolution/catalogfill.html">catalogFiil</a>, входящий в состав модуля Shopkeeper, к которому "прикручен" дополнительный функционал.

<b>Добавленные возможности:</b>
- в модуле добавлена новая вкладка "Настройки синхронизации с 1С", в которой можно сохранить след. настройки:<br />
-- адрес ссылки, по которой будет работать cron<br />
-- выбор файла конфигурации<br />
-- указание ID раздела каталога для импорта<br />

<b>Ограничения:</b>
- для импорта возможно использовать только файл в формате .csv<br />
- для запуска импорта (синхронизации) можно использовать только веб-ссылку (указанную в настройках модуля)<br />

<b>Принцип синхронизации с 1С:</b><br />
1. Программист 1С должен настроить цикличную (допустим каждый день в 8 утра) выгрузку товаров в файл формата .CSV через FTP на сервер сайта в каталог: "/корень_сайта/assets/modules/catalogFill_1C/import/" <br />
2. С помощью панели управления хостингом (или другими способами) необходимо настроить CronTab (планировщик заданий) который должен проходить по веб-ссылке, адрес которой вы указывается в модуле.<br />
3. Пройдя по ссылке, он запустит скрипт импорта товаров в базу сайта.

<b>Установка модуля:</b><br />
1. Скачайте модуль.<br />
2. Залейте скаченную папку "assets" в корень сайта. Если зальете в другую папку, то нужно будет менять пути в конфиг. файлах.<br />
3. В админке MODX, можно либо создать новый модуль, либо обновить существующий.<br />
3.1. Создаем новый: идем в "Модули" -> "Управление модулями" -> "Новый модуль"<br />
    - название: Синхронизация с 1С<br />
    - код модуля: require MODX_BASE_PATH."assets/modules/catalogFill_1С/catalog_fill_1С.inc.php";<br />
    Нажимаем кнопку "Сохранить" и жмем F5.<br />
  

3.2. Обновляем существующий модуль: идем в "Модули" -> "Управление модулями" -> кликаем по шестеренкам напротив "Импорт/экспорт товаров" -> "Редактировать"<br />
   - код модуля меняем на require MODX_BASE_PATH."assets/modules/catalogFill_1С/catalog_fill_1С.inc.php";<br />
   - сохраняем.<br />
4. Создаем новый плагин. Идем в "Элементы" -> "Управление элементами" -> "Плагины" -> "Новый плагин"<br />
  - название: 1С_sync_startPage<br />
  - код плагина: include MODX_BASE_PATH."assets/modules/catalogFill_1C/1С_sync_startPage.inc.php";<br />
  - В вкладке "События плагина", необходимо поставить галочку напротив: "OnPageNotFound"<br />
  - сохраните плагин. (данный плагин отслеживает адрес ссылки по которой открыли сайт и сравнивает её с сылкой сохрн. в модуле, если они совпадают - запустится импорт.)<br />

Установка закончена.<br />

  
<b>Настройки модуля:</b><br />
1. Открываем новосозданный (или обнововленный модуль).<br />
2. Переходим во вкладку "Настройки синхронизации с 1С"<br />
3. В поле "Адрес ссылки" вводим любую ссылку, начиная от корня сайта.<br />
  - например: /import/start.php<br />
  - получится, что ссылка для запуска будет иметь след. вид: http://site.ru/import/start.php<br />
4. Выберите файл конфигурации (подробнее о настройке этого файла - см. ниже)<br />
5. В поле "ID раздела каталога" укажите номер ID раздела каталога в который будет осуществлятся импорт<br />
6. Сохраните настройки.<br />


Настройка файла конфигурации - подробное руководство данного файла, написанно на сайте разработчика модуля - <a href="http://www.modx-shopkeeper.ru/documentation/modx-evolution/catalogfill.html" target="_blank">ссылка</a>.
Так же, в архиве имеется тестовый файл конфигурации.
<br />
Если вам необходима помощь в настройке синхронизации с 1С - стучитесь в ВК - vk.com/tanzirev
Стоимость настройки, зависит от сложности каталога и импортируемого файла.
